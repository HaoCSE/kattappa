/**
 * Kattappa - A block based rich text editor with support of Images, embeds( Youtube, twitter, etc)
 * @version v0.2.0
 * @link https://github.com/brijeshb42/kattappa
 * @license MIT
 */
{"version":3,"sources":["kattappa.embed.js"],"names":[],"mappings":"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","file":"kattappa.embed.js","sourcesContent":["(function(window) {\n\n  var APP = window.Kattappa || {};\n  var Types = APP.Blocks.Embed.Types || {};\n\n  var oEmbedUrl = '/tweet?url=';\n  var loaded = false;\n\n  var Twitter = React.createClass({\n\n    getInitialState: function() {\n      return {\n        message: 'Wait',\n        id: '',\n        valid: false,\n        html: ''\n      };\n    },\n\n    getDefaultProps: function() {\n      return {\n        url: '',\n        regex: /https?\\:\\/\\/twitter\\.com\\/(?:[a-zA-Z0-9_]+)\\/(?:status)\\/([0-9]+)\\/?(.*){0,}/gi\n      };\n    },\n\n    loadExternalScript: function() {\n      if(loaded) {\n        console.log('already loaded');\n        if(window.twttr) {\n          twttr.widgets.load();\n        }\n        return;\n      }\n      var scriptUrl = '//platform.twitter.com/widgets.js';\n      var tag = document.createElement('script');\n      tag.src = scriptUrl;\n      tag.async = 1;\n\n      tag.onload = function() {\n        loaded = true;\n        if(window.twttr) {\n          console.log('loaded now');\n          twttr.widgets.load();\n        }\n      };\n\n      window.document.body.appendChild(tag);\n    },\n\n    componentDidMount: function() {\n      this.validate();\n    },\n\n    validate: function() {\n      var match;\n      match = this.props.regex.exec(this.props.url);\n      this.props.regex.lastIndex = 0;\n      if(!match) {\n        this.props.checkContent(false);\n        this.setState({\n          message: 'error.'\n        });\n        return;\n      }\n      var self = this;\n      fetch(oEmbedUrl+this.props.url)\n        .then(function(response) {\n          if (response.status >= 200 && response.status < 300) {\n            return response.json();\n          } else {\n            var error = new Error(response.statusText);\n            error.response = response;\n            throw error;\n          }\n        }).then(function(json) {\n          if(json.html) {\n            self.setState({\n              html: '<div>'+json.html+'</div>'\n            });\n            self.loadExternalScript();\n          }\n        }).catch(function(error) {\n          console.log(error);\n          self.setState({\n            message: 'Error while loading tweet.'\n          });\n        });\n      this.setState({\n        message: 'Loading...',\n        id: match[1],\n        valid: true\n      });\n      this.props.checkContent(true);\n    },\n\n    render: function() {\n      console.log('rndr');\n      console.log(this.state);\n      if(this.state.valid) {\n        if(this.state.html === '') {\n          return (\n            <div className=\"katap-embed katap-twitter\">\n            {this.state.message}\n            </div>\n          );\n        }\n        return (\n          <div\n            className=\"katap-embed katap-twitter\"\n            dangerouslySetInnerHTML={{__html: this.state.html}} />\n        );\n      }\n      return (\n        <div className=\"katap-embed\">Invalid twitter URL.</div>\n      );\n    }\n  });\n  \n  Types.twitter = Twitter;\n  \n  APP.Blocks.Embed.Types = Types\n  window.Kattappa = APP;\n})(window);\n"],"sourceRoot":"/source/"}